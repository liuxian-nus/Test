<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../Template/generalTemplate.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns="http://www.w3.org/1999/xhtml">

    <ui:define name="content">
        <p:tabView id="tabView">  
            <p:tab id="tab1" title="Check In">  
                <h:form id="formCheckIn1">
                    <p:growl id="growl" showDetail="true" sticky="true" />   
                    <p:fieldset legend="Search Reservation By ID" toggleable="true" toggleSpeed="500" collapsed="true">  
                        <h:panelGrid columns="2" cellpadding="10">  
                            <h:outputText value="Reservation ID: " style="margin-right: 10px;"/>
                            <p:autoComplete id="reservation" value="#{reservationManagedBean.searchId}" required="true" requiredMessage="Reservation ID Cannot be Null"   
                                            completeMethod="#{reservationManagedBean.complete}" />
                            <p:spacer width="20"/>
                            <p:commandButton  value="Search" ajax="true" actionListener="#{reservationManagedBean.searchById}" update ="growl"/>
                        </h:panelGrid> 
                    </p:fieldset>
                </h:form>
                <br/>
                <h:form id="formCheckIn2">
                    <p:growl id="growl" showDetail="true" sticky="true" />   
                    <p:fieldset legend="Search Reservation By Guest Name" toggleable="true" toggleSpeed="500" collapsed="true"> 
                        <h:panelGrid columns="2" cellpadding="10">  
                            <h:outputText value="Guest Name: " style="margin-right: 10px;"/>
                            <p:autoComplete id="reservation2" value="#{reservationManagedBean.searchName}" required="true" requiredMessage="Guest Name Cannot be Null"   
                                            completeMethod="#{reservationManagedBean.complete}" />
                            <p:spacer width="20"/>
                            <p:commandButton  value="Search" ajax="true" actionListener="#{reservationManagedBean.searchByName}" update ="growl"/>
                        </h:panelGrid> 
                    </p:fieldset>
                </h:form>
                <h:form id="formCheckIn3">
                    <p:growl id="growl" showDetail="true" sticky="true" />  
                    <p:fieldset legend="Search Reservation By Guest Email" toggleable="true" toggleSpeed="500" collapsed="true"> 
                        <h:panelGrid columns="2" cellpadding="10">  
                            <h:outputText value="Reservation Email: " style="margin-right: 10px;"/>
                            <p:autoComplete id="reservation3" value="#{reservationManagedBean.searchEmail}" required="true" requiredMessage="Reservation Email Cannot be Null"   
                                            completeMethod="#{reservationManagedBean.complete}" />
                            <p:spacer width="20"/>
                            <p:commandButton  value="Search" ajax="true" actionListener="#{reservationManagedBean.searchByEmail}" update ="growl"/>
                        </h:panelGrid> 
                    </p:fieldset>
                </h:form>
                <h:form id="formCheckIn4">
                    <p:growl id="growl" showDetail="true" sticky="true" />  
                    <p:fieldset legend="Search Reservation By Date" toggleable="true" toggleSpeed="500" collapsed="true"> 
                        <h:panelGrid columns="3" cellpadding="10">  
                            <p:commandButton  value="Show today's researvations" ajax="true" actionListener="#{reservationManagedBean.getTodayReservations}" update ="growl"/>
                            <p:commandButton  value="Show past researvations" ajax="true" actionListener="#{reservationManagedBean.getBeforeReservations}" update ="growl"/>
                            <p:commandButton  value="Show all researvations" ajax="true" actionListener="#{reservationManagedBean.getAllReservations}" update ="growl"/>
                        </h:panelGrid> 
                    </p:fieldset>
                </h:form>
            </p:tab>  

            <!-- check out tab starts!! -->
            <p:tab id="tab2" title="Check out">  
                <h:form id="formCheckOut">
                    <p:growl id="growl" showDetail="true" sticky="true" />                    
                    <h:panelGrid columns="2" cellpadding="10">  
                        <h:outputText value="Room ID: " style="margin-right: 10px;"/>
                        <p:autoComplete id="room" value="#{roomManagedBean.searchId}" required="true" requiredMessage="Room ID Cannot be Null"/>
                        <p:spacer width="20"/>
                        <p:commandButton  value="Search" ajax="true" actionListener="#{roomManagedBean.searchById}" update="growl"/>
                    </h:panelGrid> 
                </h:form>
            </p:tab> 

            <!--Error: tabView:formReserve:j_idt57: "Deluxe" 必须是由一个或多个数字构成的数值。
           tabView:formReserve:j_idt57: "Deluxe" 必须是介于 -2147483648 和 2147483647 之间的数值。示例: 9346-->
            <p:tab id="tab3" title="Make Reservation">  
                <h:form id="formReserve">
                    <p:growl id="growl" showDetail="true" sticky="true" />                    
                    <h:panelGrid columns="3" cellpadding="10">  
                        <h:outputText value="Guest Name*:"/>
                        <h:inputText required ="true" requiredMessage="Name cannot be empty" value="#{reservationManagedBean.newReservation.rcName}"/>                                   
                        <h:outputText value=""/>
                        <h:outputText value="Email*:"/>
                        <h:inputText required ="true" requiredMessage="Email cannot be empty" value="#{reservationManagedBean.newReservation.rcEmail}"/>                                   
                        <h:outputText value=""/>
                        <h:outputText value="Credit Card Number*:"/>
                        <h:inputText required ="true" requiredMessage="Credit Card cannot be empty" value="#{reservationManagedBean.newReservation.rcCreditCardNo}"/>                                   
                        <h:outputText value=""/>
                        <h:outputText value="Hand Phone Number*:"/>
                        <h:inputText required ="true" requiredMessage="Name cannot be empty" value="#{reservationManagedBean.newReservation.rcHP}"/>                                   
                        <h:outputText value=""/>
                        <h:outputText value="CheckIn Date*:"/>
                        <p:calendar pattern="yyyy-MM-dd" yearRange="0" showButtonPanel="true" navigator="true" id="customCal1" value="#{reservationManagedBean.newReservation.rcCheckInDate}" /> 
                        <h:outputText value=""/>
                        <h:outputText value="CheckOut Date*:"/>
                        <p:calendar pattern="yyyy-MM-dd" yearRange="0" showButtonPanel="true" navigator="true" id="customCal2" value="#{reservationManagedBean.newReservation.rcCheckOutDate}" /> 
                        <h:outputText value=""/>
                        <h:outputText value="Hotel*:"/>
                        <h:selectOneRadio value ="#{reservationManagedBean.newReservation.reservationHotelNo}" required ="true" requiredMessage="You have to choose a hotel">
                            <f:selectItem itemLabel="Orchard Hotel" itemValue="1" />  
                            <f:selectItem itemLabel="Marina Hotel" itemValue="2" />  
                            <f:selectItem itemLabel="BeachView Hotel" itemValue="3" />  
                        </h:selectOneRadio> 
                        <h:outputText value=""/>
                        <h:outputText value="Number of Rooms*:"/>
                        <h:inputText required ="true" requiredMessage="Number of rooms cannot be empty" value="#{reservationManagedBean.newReservation.reservationRoomCount}"/>                                   
                        <h:outputText value=""/>
                        <h:outputText value="Number of Guests:"/>
                        <h:inputText value="#{reservationManagedBean.newReservation.reservationGuestCount}"/>                                   
                        <h:outputText value=""/>
                        <h:outputText value="Room Type*:"/>
                        <h:selectOneMenu value ="#{reservationManagedBean.newReservation.reservationRoomType}" required ="true" requiredMessage="You have to specify your room type">
                            <f:selectItem itemLabel="Select Room Type" itemValue="" />  
                            <f:selectItem itemLabel="Superior" itemValue="1" />  
                            <f:selectItem itemLabel="Deluxe" itemValue="2" />  
                            <f:selectItem itemLabel="Deluxe Suite" itemValue="3" />  
                            <f:selectItem itemLabel="Orchard Suite" itemValue="4" />  
                            <f:selectItem itemLabel="Chairman Suite" itemValue="5" />  
                        </h:selectOneMenu> 
                        <h:outputText value=""/>
                        <h:outputText value="Corporate (If applicable):"/>
                        <h:inputText value="#{reservationManagedBean.newReservation.reservationCorporate}"/>                                   
                        <h:outputText value=""/>

                        <p:spacer width="20"/>
                        <p:commandButton  value="Reserve Now" ajax="true" oncomplete="confirmation.show()" icon="ui-icon ui-icon-check" />

                        <p:dialog width="300" showEffect="explode" hideEffect="explode" header="Confirmation" widgetVar="confirmation">
                            <h:panelGrid id="display" columns="2" cellpadding="4" style="margin:0 auto;">
                                <h:outputText value="Confirm Reservation?"/>
                                <h:outputText value=""/>
                                <p:commandButton value="Yes" update="growl" actionListener="#{reservationManagedBean.addReservation}" oncomplete="confirmation.hide()">  
                                </p:commandButton>
                                <p:commandButton value="Cancel" onclick="confirmation.hide()" type="button"/>  
                            </h:panelGrid>
                        </p:dialog>  

                    </h:panelGrid> 
                </h:form>
            </p:tab> 



            <p:tab id="viewReservations" title="View Reservations">  
                <h:form id="unpaidoverdue">
                    <p:growl id="growl" showDetail="true" sticky="true" />   
                    <p:fieldset legend="All Reservations" toggleable="true" toggleSpeed="500" collapsed="true">  
                        <p:panel id="bills" header="All Reservations" style="height:500px;">
                            <div style="margin-top:20px;margin-bottom:20px;">

                                <p:dataTable id="reservationList" value="#{reservationManagedBean.all}" var="reservations" paginator="true" rows="10">
                                    <p:column headerText ="ID:">
                                        <h:outputText value="#{reservations.reservationId}"/> 
                                    </p:column>
                                    <p:column id="emailColumn" filterBy="#{reservations.rcEmail}"   
                                              headerText="Reservation Email" filterMatchMode="contains">  
                                        <h:outputText value="#{reservations.rcEmail}" />  
                                    </p:column>  

                                    <p:column id="nameColumn" filterBy="#{reservations.rcName}" headerText ="Guest Name:" filterMatchMode="contains">
                                        <h:outputText value="#{reservations.rcName}"/> 
                                    </p:column>

                                    <p:column headerText ="Check In Date:">
                                        <h:outputText value="#{reservations.rcCheckInDate}">
                                            <f:convertDateTime pattern="dd-MM-yyyy" />
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText ="Check Out Date:">
                                        <h:outputText value="#{reservations.rcCheckOutDate}"> 
                                            <f:convertDateTime pattern="dd-MM-yyyy" />
                                        </h:outputText>
                                    </p:column>

                                    <p:column id="status" filterBy="#{reservations.reservationStatus}" headerText ="Status:" filterMatchMode="contains">
                                        <h:outputText value="#{reservations.reservationStatus}"/> 
                                    </p:column>

                                    <p:column style="width:100px">  
                                        <p:commandButton rendered="#{reservations.reservationStatus != 'checkedIn'}"  actionListener="#{reservationManagedBean.viewReservation}" ajax="true"  icon="ui-icon ui-icon-search" value ="View" title="View this reservation">  
                                            <f:setPropertyActionListener target="#{reservationManagedBean.selectReservation}" value="#{reservations}"/>  
                                        </p:commandButton>

                                        <p:commandButton rendered="#{reservations.reservationStatus != 'checkedIn'}" oncomplete="confirmation.show()" ajax="true"  icon="ui-icon ui-icon-close" value ="Cancel" title="Cancel this reservation">  
                                            <f:setPropertyActionListener target="#{reservationManagedBean.selectReservation}" value="#{reservations}"/>  
                                        </p:commandButton>

                                        <h:outputText rendered="#{reservations.reservationStatus == 'checkedIn'}" value="Checked In" >  
                                        </h:outputText>  
                                    </p:column>
                                </p:dataTable>


                                <p:dialog width="300" showEffect="explode" hideEffect="explode" header="Confirmation" widgetVar="confirmation"> 
                                    <h:outputText value="Are you sure to cancel this reservation? "/>
                                    <p:commandButton value="Yes" onclick="growl;" update ="reservationList" actionListener="#{reservationManagedBean.cancelReservation}" oncomplete="confirmation.hide()">  
                                    </p:commandButton>
                                    <p:commandButton value="Cancel" onclick="confirmation.hide()" type="button"/>  
                                </p:dialog>  

                            </div>
                        </p:panel>

                    </p:fieldset>
                </h:form>
                <br/>



                <h:form id="todayReservation">
                    <p:growl id="growl" showDetail="true" sticky="true" />   
                    <p:fieldset legend="Today's Reservations" toggleable="true" toggleSpeed="500" collapsed="true">  
                        <p:panel id="bills" header="Today's Reservations" style="height:500px;">
                            <div style="margin-top:20px;margin-bottom:20px;">

                                <p:dataTable id="reservationList" value="#{reservationManagedBean.today}" var="reservations" paginator="true" rows="10">
                                    <p:column headerText ="ID:">
                                        <h:outputText value="#{reservations.reservationId}"/> 
                                    </p:column>
                                    <p:column id="emailColumn" filterBy="#{reservations.rcEmail}"   
                                              headerText="Reservation Email" filterMatchMode="contains">  
                                        <h:outputText value="#{reservations.rcEmail}" />  
                                    </p:column>  

                                    <p:column id="nameColumn" filterBy="#{reservations.rcName}" headerText ="Guest Name:" filterMatchMode="contains">
                                        <h:outputText value="#{reservations.rcName}"/> 
                                    </p:column>

                                    <p:column headerText ="Check In Date:">
                                        <h:outputText value="#{reservations.rcCheckInDate}">
                                            <f:convertDateTime pattern="dd-MM-yyyy" />
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText ="Check Out Date:">
                                        <h:outputText value="#{reservations.rcCheckOutDate}"> 
                                            <f:convertDateTime pattern="dd-MM-yyyy" />
                                        </h:outputText>
                                    </p:column>

                                    <p:column id="status" filterBy="#{reservations.reservationStatus}" headerText ="Status:" filterMatchMode="contains">
                                        <h:outputText value="#{reservations.reservationStatus}"/> 
                                    </p:column>

                                    <p:column style="width:100px">  
                                        <p:commandButton rendered="#{reservations.reservationStatus != 'checkedIn'}"  actionListener="#{reservationManagedBean.viewReservation}" ajax="true"  icon="ui-icon ui-icon-search" value ="View" title="View this reservation">  
                                            <f:setPropertyActionListener target="#{reservationManagedBean.selectReservation}" value="#{reservations}"/>  
                                        </p:commandButton>

                                        <p:commandButton rendered="#{reservations.reservationStatus != 'checkedIn'}" oncomplete="confirmation2.show()" ajax="true"  icon="ui-icon ui-icon-close" value ="Cancel" title="Cancel this reservation">  
                                            <f:setPropertyActionListener target="#{reservationManagedBean.selectReservation}" value="#{reservations}"/>  
                                        </p:commandButton>

                                        <h:outputText rendered="#{reservations.reservationStatus == 'checkedIn'}" value="Checked In" >  
                                        </h:outputText>  
                                    </p:column>
                                </p:dataTable>


                                <p:dialog width="300" showEffect="explode" hideEffect="explode" header="Confirmation" widgetVar="confirmation2"> 
                                    <h:outputText value="Are you sure to cancel this reservation? "/>
                                    <p:commandButton value="Yes" onclick="growl;" update ="reservationList" actionListener="#{reservationManagedBean.cancelReservation}" oncomplete="confirmation2.hide()">  
                                    </p:commandButton>
                                    <p:commandButton value="Cancel" onclick="confirmation2.hide()" type="button"/>  
                                </p:dialog>  

                            </div>
                        </p:panel>

                    </p:fieldset>
                </h:form>
                <br/>

                <h:form id="overdueReservations">
                    <p:growl id="growl" showDetail="true" sticky="true" />   
                    <p:fieldset legend="Overdue Reservations" toggleable="true" toggleSpeed="500" collapsed="true">  
                        <p:panel id="bills" header="Overdue Reservations" style="height:500px;">
                            <div style="margin-top:20px;margin-bottom:20px;">

                                <p:dataTable id="reservationList" value="#{reservationManagedBean.overdue}" var="reservations" paginator="true" rows="10">
                                    <p:column headerText ="ID:">
                                        <h:outputText value="#{reservations.reservationId}"/> 
                                    </p:column>
                                    <p:column id="emailColumn" filterBy="#{reservations.rcEmail}"   
                                              headerText="Reservation Email" filterMatchMode="contains">  
                                        <h:outputText value="#{reservations.rcEmail}" />  
                                    </p:column>  

                                    <p:column id="nameColumn" filterBy="#{reservations.rcName}" headerText ="Guest Name:" filterMatchMode="contains">
                                        <h:outputText value="#{reservations.rcName}"/> 
                                    </p:column>

                                    <p:column headerText ="Check In Date:">
                                        <h:outputText value="#{reservations.rcCheckInDate}">
                                            <f:convertDateTime pattern="dd-MM-yyyy" />
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText ="Check Out Date:">
                                        <h:outputText value="#{reservations.rcCheckOutDate}"> 
                                            <f:convertDateTime pattern="dd-MM-yyyy" />
                                        </h:outputText>
                                    </p:column>

                                    <p:column id="status" filterBy="#{reservations.reservationStatus}" headerText ="Status:" filterMatchMode="contains">
                                        <h:outputText value="#{reservations.reservationStatus}"/> 
                                    </p:column>

                                    <p:column style="width:100px">  
                                        <p:commandButton rendered="#{reservations.reservationStatus!='Canceled'and reservations.reservationStatus != 'checkedIn'}"  actionListener="#{reservationManagedBean.viewReservation}" ajax="true"  icon="ui-icon ui-icon-search" value ="View" title="View this reservation">  
                                            <f:setPropertyActionListener target="#{reservationManagedBean.selectReservation}" value="#{reservations}"/>  
                                        </p:commandButton>

                                        <p:commandButton rendered="#{reservations.reservationStatus != 'checkedIn'and reservations.reservationStatus!='Canceled'}" oncomplete="confirmation3.show()" ajax="true"  icon="ui-icon ui-icon-close" value ="Cancel" title="Cancel this reservation">  
                                            <f:setPropertyActionListener target="#{reservationManagedBean.selectReservation}" value="#{reservations}"/>  
                                        </p:commandButton>

                                        <h:outputText rendered="#{reservations.reservationStatus == 'checkedIn'}" value="Checked In" />  
                                        <h:outputText rendered="#{reservations.reservationStatus == 'Canceled'}" value="Canceled" />  

                                    </p:column>
                                </p:dataTable>


                                <p:dialog width="300" showEffect="explode" hideEffect="explode" header="Confirmation" widgetVar="confirmation3"> 
                                    <h:outputText value="Are you sure to cancel this reservation? "/>
                                    <p:commandButton value="Yes" onclick="growl;" update ="reservationList" actionListener="#{reservationManagedBean.cancelReservation}" oncomplete="confirmation3.hide()">  
                                    </p:commandButton>
                                    <p:commandButton value="Cancel" onclick="confirmation3.hide()" type="button"/>  
                                </p:dialog>  

                            </div>
                        </p:panel>

                    </p:fieldset>
                </h:form>
                <br/>










            </p:tab> 

        </p:tabView>
    </ui:define>

</ui:composition>
